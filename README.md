# Alpha Parser

–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–∞–Ω–∞–ª –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ç–µ–ª–µ–≥—Ä–∞–º–º –∫–∞–Ω–∞–ª–æ–≤. –í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–≥—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é. –ö–∞–Ω–∞–ª—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
alpha-parser/
‚îú‚îÄ‚îÄ src/                           # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ RUN4.py                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ CONFIG.py                  # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ channel_processors.py      # –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ config_validator.py        # –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic)
‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py              # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env.test                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (–ù–ï –≤ git!)
‚îú‚îÄ‚îÄ .env.production                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—á–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (–ù–ï –≤ git!)
‚îú‚îÄ‚îÄ .env                           # –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ switch_to_test.bat            # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç (Windows)
‚îú‚îÄ‚îÄ switch_to_test.sh              # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç (Linux/Mac)
‚îú‚îÄ‚îÄ switch_to_production.bat       # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω (Windows)
‚îú‚îÄ‚îÄ switch_to_production.sh        # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω (Linux/Mac)
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Dockerfile                     # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml             # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ entrypoint.sh                  # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤ Docker
‚îú‚îÄ‚îÄ DEPLOYMENT_GUIDE.md            # –ü–æ–ª–Ω—ã–π –≥–∞–π–¥ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚îú‚îÄ‚îÄ ACCOUNT_SWITCHING_GUIDE.md     # –ü–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥ –ø–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—é –∞–∫–∫–∞—É–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ CREATE_ENV_FILES.md            # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é .env —Ñ–∞–π–ª–æ–≤
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (`ENV_MODE=test`):**
- `userbot2_test_session.session` - —Å–µ—Å—Å–∏—è Telegram
- `channels_v2_test.db` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –ø–æ—Å—Ç–æ–≤
- `userbot2_test.log` - –ª–æ–≥–∏

**–ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º (`ENV_MODE=production`):**
- `userbot2_session.session` - —Å–µ—Å—Å–∏—è Telegram
- `channels_v2.db` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –ø–æ—Å—Ç–æ–≤
- `userbot2.log` - –ª–æ–≥–∏

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –í—Å–µ `.env.*` —Ñ–∞–π–ª—ã, —Å–µ—Å—Å–∏–∏, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `.gitignore` –∏ –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ git!

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `.env.test` –∏ `.env.production` (—Å–º. `CREATE_ENV_FILES.md`)
   - –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (API –∫–ª—é—á–∏, –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, –ø—Ä–æ–º–ø—Ç—ã) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - ‚ö†Ô∏è **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env.*` —Ñ–∞–π–ª—ã –≤ git!**

3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –Ω—É–∂–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   - **Windows:** `.\switch_to_test.bat` –∏–ª–∏ `.\switch_to_production.bat`
   - **Linux/Mac:** `./switch_to_test.sh` –∏–ª–∏ `./switch_to_production.sh`

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python -m src.RUN4
```

## –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Å—Ç–æ–º –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –¥–≤—É–º—è —Ä–∞–∑–Ω—ã–º–∏ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏:
- **–¢–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç** ‚Äî –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–†–∞–±–æ—á–∏–π –∞–∫–∫–∞—É–Ω—Ç** ‚Äî –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞

### –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

**Windows:**
```powershell
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç
.\switch_to_test.bat

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
.\switch_to_production.bat
```

**Linux/Mac:**
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç
./switch_to_test.sh

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
./switch_to_production.sh
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏

1. –°–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `.env.*` —Ñ–∞–π–ª –≤ `.env`
2. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
   - –û—Ç–¥–µ–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é Telegram (`.session` —Ñ–∞–π–ª)
   - –û—Ç–¥–µ–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (`.db` —Ñ–∞–π–ª)
   - –û—Ç–¥–µ–ª—å–Ω—ã–π –ª–æ–≥ —Ñ–∞–π–ª (`.log` —Ñ–∞–π–ª)

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é –º–µ–∂–¥—É —Ç–µ—Å—Ç–æ–≤—ã–º –∏ —Ä–∞–±–æ—á–∏–º –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞

```powershell
# Windows
Get-Content .env | Select-String "ENV_MODE"

# Linux/Mac
grep ENV_MODE .env
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º. [ACCOUNT_SWITCHING_GUIDE.md](ACCOUNT_SWITCHING_GUIDE.md)

## –ó–∞–ø—É—Å–∫ –≤ Docker

### üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±: Docker Compose

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç `docker-compose.yml` –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º.

**üìñ –ü–æ–ª–Ω—ã–π –≥–∞–π–¥ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:** [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md)

#### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Ñ–∞–π–ª .env
mkdir -p /opt/alpha-parser/data
nano /opt/alpha-parser/data/.env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Docker Compose
cd /opt/alpha-parser
docker compose up -d

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs -f alpha-parser
```

#### –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º (–ª–æ–≥–∏ –∏ –ë–î):

–§–∞–π–ª-—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É **8080**:

- **–ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:** `http://your-server-ip:8080/`
- **–ß–µ—Ä–µ–∑ curl:** `curl http://your-server-ip:8080/channels_v2.db -o backup.db`

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```bash
docker compose ps              # —Å—Ç–∞—Ç—É—Å
docker compose logs -f         # –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose restart         # –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose down            # –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose up -d           # –∑–∞–ø—É—Å–∫
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: Docker run

–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker Compose:

```bash
docker build -t alpha-parser:latest .

docker run -d \
  --name alpha-parser \
  --restart unless-stopped \
  -v /opt/alpha-parser/data:/data \
  --env-file /opt/alpha-parser/data/.env \
  alpha-parser:latest
```

–ì–¥–µ `/opt/alpha-parser/data` ‚Äì –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞ —Ö–æ—Å—Ç–µ, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è:
- `.env` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- `channels_v2.db` (–∏–ª–∏ `channels_v2_test.db` –¥–ª—è —Ç–µ—Å—Ç–∞)
- `userbot2_session.session` (–∏–ª–∏ `userbot2_test_session.session` –¥–ª—è —Ç–µ—Å—Ç–∞)
- `userbot2.log` (–∏–ª–∏ `userbot2_test.log` –¥–ª—è —Ç–µ—Å—Ç–∞)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º SOLID –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Pydantic
- ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å type hints
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–∞–Ω–∞–ª–æ–≤
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏ –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–π —Å –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ `AuthKeyDuplicatedError` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

